---
title: "Project title"
subtitle: "Report"
---

```{r}
library(tidyverse)
library(tidymodels)
library(probably)
library(skimr)
```

# Introduction


# Data description


# Data analysis
```{r}
sweet_edu_df <- coffee_clean_factors |>
  select(education_level, contains("sugar_sweetener_add")) |>
  drop_na() |>
  mutate(like_sweet = (sugar_sweetener_add_granulated_sugar |
                         sugar_sweetener_add_artificial_sweeteners |
                         sugar_sweetener_add_honey |
                         sugar_sweetener_add_maple_syrup |
                         sugar_sweetener_add_stevia |
                         sugar_sweetener_add_agave_nectar |
                         sugar_sweetener_add_brown_sugar |
                         sugar_sweetener_add_raw_sugar))
names(sweet_edu_df) <- gsub("sugar_sweetener_add_", "", names(sweet_edu_df))

sweet_edu_df <- sweet_edu_df |> 
  mutate(education_level = case_when(
    education_level %in% c("Bachelor's degree", "Master's degree", "Doctorate or professional degree") ~ "bachelor",
    TRUE ~ "no_bachelor"
  )) |>
  mutate(education_level = factor(education_level,
                                  c("bachelor",
                                    "no_bachelor")))

sweet_edu_df2 <- sweet_edu_df |>
  pivot_longer(
    cols = 2:9,
    names_to = "sweetener",
    values_to = "add"
  ) 

sweet_edu_df3 <- sweet_edu_df2 |>
  select(education_level, sweetener, add)|>
  filter(add == TRUE)

sweet_edu_df <- sweet_edu_df
  
#Popularity of sweeteners
sweet_edu_df2 |>
  ggplot(aes(y = sweetener, fill = add) ) +
  geom_bar()

#number of added sweeteners by education level
sweet_edu_df2 |>
  ggplot(aes(y = education_level), fill = add, color = "blue") +
  geom_bar()

#sweetener preference proportions by education level
sweet_edu_df2 |>
  ggplot(aes(y = sweetener, fill = add) ) +
  geom_bar(position = "fill") +
  facet_wrap(.~education_level)

#proportion preferring sweetener by education level
sweet_edu_df2 |>
  ggplot(aes(y = education_level, fill = add) ) +
  geom_bar(position = "fill") +
  facet_wrap(.~sweetener)

           
```

# Evaluation of significance

```{r}

edu_sweetener_fit1 <- logistic_reg() |>
  fit(education_level ~ sweetener, data = sweet_edu_df3)
tidy(edu_sweetener_fit1)


# edu_sweetener_fit2 <- logistic_reg() |>
#   fit(education_level ~ granulated_sugar, data = sweet_edu_df)
# tidy(edu_sweetener_fit)

```

# Interpretation and conclusions

Adding artificial sweeteners, granulated sugar, honey, raw sugar, or stevia in their coffee is on average associated with an increase of the log-odds of having a bachelor or higher education degree compared to the reference category agave nectar.
Adding brown sugar or maple syrup is on average associated with a decrease in log-odds of having a bachelor or higher education degree compared to the reference category of agave nectar.

# Limitations


# Acknowledgments

